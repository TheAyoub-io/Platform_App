
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travel Recommendation</title>
</head>
<body>
    <h1>Sign Up</h1>
    <form id="signupForm">
        <input type="text" name="username" placeholder="Username" required><br>
        <input type="email" name="email" placeholder="Email" required><br>
        <input type="password" name="password" placeholder="Password" required><br>
        <button type="submit">Sign Up</button>
    </form>

    <h1>Login</h1>
    <form id="loginForm">
        <input type="text" name="username" placeholder="Username" required><br>
        <input type="password" name="password" placeholder="Password" required><br>
        <button type="submit">Login</button>
    </form>

    <h1>Get a Recommendation</h1>
    <form id="recommendationForm">
        <label for="Age">Age:</label><br>
        <input type="number" id="Age" name="Age" required><br><br>

        <label for="Budget">Budget:</label><br>
        <input type="number" id="Budget" name="Budget" required><br><br>

        <label for="Interet">Interest:</label><br>
        <input type="text" id="Interet" name="Interet" required><br><br>

        <label for="Duree">Duration (days):</label><br>
        <input type="number" id="Duree" name="Duree" required><br><br>

        <label for="Climat">Climate:</label><br>
        <input type="text" id="Climat" name="Climat" required><br><br>

        <label for="Continent">Continent:</label><br>
        <input type="text" id="Continent" name="Continent" required><br><br>

        <label for="Type_Destination">Destination Type:</label><br>
        <input type="text" id="Type_Destination" name="Type_Destination" required><br><br>

        <button type="submit">Get Recommendation</button>
    </form>

    <div id="result"></div>

    <script>
        document.getElementById('signupForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());
            const response = await fetch('/signup/', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            document.getElementById('result').innerText = JSON.stringify(result);
        });

        document.getElementById('loginForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const formData = new FormData(this);
            const response = await fetch('/token', {
                method: 'POST',
                body: formData
            });
            const result = await response.json();
            if (result.access_token) {
                localStorage.setItem('token', result.access_token);
                document.getElementById('result').innerText = 'Logged in successfully!';
            } else {
                document.getElementById('result').innerText = JSON.stringify(result);
            }
        });

        document.getElementById('recommendationForm').addEventListener('submit', async function (e) {
            e.preventDefault();
            const token = localStorage.getItem('token');
            if (!token) {
                document.getElementById('result').innerText = 'You must be logged in to get a recommendation.';
                return;
            }

            const formData = new FormData(this);
            const data = Object.fromEntries(formData.entries());

            // Convert numeric fields
            data.Age = parseInt(data.Age);
            data.Budget = parseInt(data.Budget);
            data.Duree = parseInt(data.Duree);

            const response = await fetch('/recommend/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${token}`
                },
                body: JSON.stringify(data)
            });
            const result = await response.json();
            document.getElementById('result').innerText = JSON.stringify(result);
        });
    </script>
</body>
</html>
